(()=>{var u=Object.defineProperty;var f=(e,t,n)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var a=(e,t,n)=>f(e,typeof t!="symbol"?t+"":t,n);var c=(e=>(e.NEW_MESSAGE="newMessage",e.READ_MESSAGE="readMessage",e.READ_ALL="readAll",e))(c||{});class h{constructor(t){a(this,"component");a(this,"isInitClickEvents",!1);this.component=t,this.clickEvents()}add(t){const n=this.component.querySelector(".notification-items");if(n===null)return;n.insertAdjacentHTML("afterbegin",t),this.clickEvents(),this.component.style.display="block";const i=this.component.querySelector(".notifications-icon");i!==null&&(i.classList.add("swing-animation"),i.addEventListener("animationend",()=>{i.classList.remove("swing-animation")}))}read(t){const n=this.component.querySelector(`.notifications-item[data-id="${t}"]`);if(n===null)return;n.remove(),this.component.querySelectorAll(".notifications-item").length===0&&this.hideNotifications()}readAll(){const t=this.component.querySelectorAll(".notifications-item");t.length!==0&&(t.forEach(n=>{n.classList.add("slide-out-right"),n.addEventListener("animationend",()=>{n.remove()})}),setTimeout(()=>{this.hideNotifications()},300))}clickEvents(){if(this.isInitClickEvents)return;const t=document.getElementById("rush-notifications-container");t!==null&&(t.addEventListener("click",async n=>{n.preventDefault();const i=n.target;if(i.closest(".notifications-remove")){const o=i.closest(".notifications-item");if(o===null)return;const s=o.querySelector(".notifications-remove");if(s===null)return;const l=s.getAttribute("href");if(l===null)return;o.classList.add("slide-out-right"),o.addEventListener("animationend",()=>{o.remove(),this.component.querySelectorAll(".notifications-item").length===0&&this.hideNotifications()});try{if((await fetch(l,{method:"GET"})).status!==200){o.style.display="block";return}}catch{o.style.display="block"}}if(i.classList.contains("notifications-read")){const o=i.getAttribute("href");if(o===null)return;this.readAll();try{if((await fetch(o,{method:"GET"})).status!==200&&this.component!==null){this.component.style.display="block";return}}catch{this.component!==null&&(this.component.style.display="block")}}}),this.isInitClickEvents=!0)}hideNotifications(){this.component.style.display="none";const t=this.component.querySelector(".dropdown-body");t!==null&&t.classList.remove("pointer-events-auto","visible","opacity-100")}}let r;document.addEventListener("moonshine:rush",()=>{r=window.MoonShine;const e=document.getElementById("header-notifications");if(e===null)return;const t=e.getAttribute("data-channel");if(t===null)return;const n=document.getElementById("rushNotifications");if(n===null)return;const i=new h(n);r.callbacks.onMoonShineWS&&r.callbacks.onMoonShineWS(t,o=>{let s;switch(o.event){case c.NEW_MESSAGE:s=o.data,i.add(s.html);break;case c.READ_MESSAGE:s=o.data,i.read(s.notificationId);break;case c.READ_ALL:i.readAll();break}})});
})()